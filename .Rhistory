library(tidyverse)
library(sf)
library(units)
parcels_bus <- st_read("D:/Spatial_Optimization/Final/data/parcels_bus.shp")
parcels_bus_buffer <- parcels_bus %>%
st_buffer(dist = units::set_units(0.25, "mi")) %>%
group_by(FacilityID) %>%
summarise()
View(parcels_bus_buffer)
plot(parcels_bus_buffer)
st_write(parcels_bus_buffer, "D:/Spatial_Optimization/Final/data/parcels_bus_buffer.shp")
View(parcels_bus_buffer)
parcels_rail <- st_read("D:/Spatial_Optimization/Final/data/parcels_rail.shp")
View(parcels_rail)
parcels_rail <- st_read("D:/Spatial_Optimization/Final/data/parcels_rail.shp")
View(parcels_rail)
View(parcels_bus)
st_write(parcels_bus, "D:/Spatial_Optimization/Final/data/parcels_bus.shp")
library(tidyverse)
library(sf)
library(units)
parcels_rail <- st_read("D:/Spatial_Optimization/Final/data/parcels_rail.shp")
View(parcels_rail)
parcels_rail_buffer <- parcels_rail %>%
st_buffer(dist = units::set_units(0.5, "mi")) %>%
group_by(FacilityID) %>%
summarise()
st_write(parcels_rail_buffer, "D:/Spatial_Optimization/Final/data/parcels_rail_buffer.shp")
library(tidyverse)
library(sf)
library(units)
zoning_regulation <- read.csv("D:/Spatial_Optimization/Final/data/zoning.csv")
View(zoning_regulation)
land_use <- st_read("https://opendata.arcgis.com/datasets/e433504739bd41049de5d8f4a22d34ba_0.geojson")
zoning <- st_read("https://opendata.arcgis.com/datasets/0bdb0b5f13774c03abf8dc2f1aa01693_0.geojson")
property <- read.csv("https://opendata-downloads.s3.amazonaws.com/opa_properties_public.csv")
property <- read.csv("https://opendata-downloads.s3.amazonaws.com/opa_properties_public.csv")
vacant_land <- land_use %>%
filter(C_DIG2 == 91)
r_area <- zoning %>%
filter(ZONINGGROUP == "Residential/Residential Mixed-Use")
pub_var <- c("CITY", "PHILA")
city_owned <- property %>%
rename(geometry = shape) %>%
st_as_sf(wkt = "geometry", crs = 2272) %>%
dplyr::select(market_value, category_code_description, owner_1, owner_2) %>%
filter(category_code_description == "VACANT LAND") %>%
mutate(owner = paste0(owner_1, " ", owner_2)) %>%
dplyr::select(-owner_1, -owner_2) %>%
filter(str_detect(owner, paste(pub_var, collapse = "|"))) %>%
st_transform(st_crs(vacant_land))
st_write(vacant_land, "D:/Spatial_Optimization/Final/data/vacant_land.shp")
st_write(r_area, "D:/Spatial_Optimization/Final/data/r_area.shp")
View(r_area)
View(r_area)
st_write(r_area, "D:/Spatial_Optimization/Final/data/r_area.shp")
st_write(r_area, "D:/Spatial_Optimization/Final/data/residential_area.shp")
View(r_area)
st_write(r_area %>%
dplyr::select(CODE, geometry), "D:/Spatial_Optimization/Final/data/re_area.shp")
st_write(city_owned, "D:/Spatial_Optimization/Final/data/city_owned.shp")
library(tidyverse)
library(sf)
library(units)
zoning_regulation <- read.csv("D:/Spatial_Optimization/Final/data/zoning.csv")
View(zoning_regulation)
library(tidyverse)
library(sf)
library(units)
vacant_land <- land_use %>%
filter(C_DIG2 == 91)
land_use <- st_read("https://opendata.arcgis.com/datasets/e433504739bd41049de5d8f4a22d34ba_0.geojson")
zoning <- st_read("https://opendata.arcgis.com/datasets/0bdb0b5f13774c03abf8dc2f1aa01693_0.geojson")
property <- read.csv("https://opendata-downloads.s3.amazonaws.com/opa_properties_public.csv")
zoning_regulation <- read.csv("D:/Spatial_Optimization/Final/data/zoning.csv")
vacant_land <- land_use %>%
filter(C_DIG2 == 91)
st_write(city_owned, "D:/Spatial_Optimization/Final/data/city_owned.shp")
vacant_land <- land_use %>%
filter(C_DIG2 == 91)
st_write(city_owned, "D:/Spatial_Optimization/Final/data/city_owned.shp")
vacant_land <- land_use %>%
filter(C_DIG2 == 91)
# st_write(city_owned, "D:/Spatial_Optimization/Final/data/city_owned.shp")
r_area <- zoning %>%
filter(ZONINGGROUP == "Residential/Residential Mixed-Use")
pub_var <- c("CITY", "PHILA")
city_owned <- property %>%
rename(geometry = shape) %>%
st_as_sf(wkt = "geometry", crs = 2272) %>%
dplyr::select(market_value, category_code_description, owner_1, owner_2) %>%
filter(category_code_description == "VACANT LAND") %>%
mutate(owner = paste0(owner_1, " ", owner_2)) %>%
dplyr::select(-owner_1, -owner_2) %>%
filter(str_detect(owner, paste(pub_var, collapse = "|"))) %>%
st_transform(st_crs(vacant_land))
city_owned_vland <- city_owned %>%
st_join(vacant_land, .) %>%
filter(! is.na(owner))
parcels <- city_owned_vland %>%
st_join(., r_area, join = st_within) %>%
filter(! is.na(CODE)) %>%
st_transform("ESRI:102728") %>%
mutate(area_sqft = as.numeric(set_units(st_area(geometry), "ft^2"))) %>%
dplyr::select(C_DIG2, owner, CODE, market_value, area_sqft, geometry)
parcels <- parcels %>%
left_join(., zoning_regulation, by = "CODE")
parcels_RSD <- parcels %>%
filter(str_detect(CODE, "RSD")) %>%
mutate(units = 1)
RM_var <- c("RM2", "RM3", "RM4")
parcels_RSA <- parcels %>%
filter(! str_detect(CODE, paste(RM_var, collapse = "|")),
! str_detect(CODE, "RSD")) %>%
# ,area_sqft > min.lot.area)
mutate(units = floor(area_sqft * Max.occupied / unit.area))
parcels_RM <- parcels %>%
filter(str_detect(CODE, paste(RM_var, collapse = "|"))) %>%
# ,area_sqft > min.lot.area)
mutate(units = floor(area_sqft * FAR / unit.area))
final_parcels <- rbind(parcels_RSD, parcels_RSA, parcels_RM)
# final_parcels %>%
#   dplyr::select(market_value, units, geometry) %>%
#   st_write("D:/Spatial_Optimization/Final/data/parcels.shp")
# final_parcels %>%
#   dplyr::select(market_value, units, geometry) %>%
#   st_centroid() %>%
#   st_write("D:/Spatial_Optimization/Final/data/all_parcels_nodes.shp")
final_parcels %>%
dplyr::select(market_value, units, geometry) %>%
st_centroid() %>%
st_write("D:/Spatial_Optimization/Final/data/all_parcels_nodes.shp")
View(final_parcels)
sum(final_parcels$units)
parcels <- parcels %>%
left_join(., zoning_regulation, by = "CODE")
parcels_RSD <- parcels %>%
filter(str_detect(CODE, "RSD")) %>%
mutate(units = 1)
RM_var <- c("RM2", "RM3", "RM4")
parcels_RSA <- parcels %>%
filter(! str_detect(CODE, paste(RM_var, collapse = "|")),
! str_detect(CODE, "RSD")) %>%
# ,area_sqft > min.lot.area)
mutate(units = floor(area_sqft * Max.occupied / unit.area))
city_owned_vland <- city_owned %>%
st_join(vacant_land, .) %>%
filter(! is.na(owner))
parcels <- city_owned_vland %>%
st_join(., r_area, join = st_within) %>%
filter(! is.na(CODE)) %>%
st_transform("ESRI:102728") %>%
mutate(area_sqft = as.numeric(set_units(st_area(geometry), "ft^2"))) %>%
dplyr::select(C_DIG2, owner, CODE, market_value, area_sqft, geometry)
parcels <- parcels %>%
left_join(., zoning_regulation, by = "CODE")
parcels_RSD <- parcels %>%
filter(str_detect(CODE, "RSD")) %>%
mutate(units = 1)
RM_var <- c("RM2", "RM3", "RM4")
parcels_RSA <- parcels %>%
filter(! str_detect(CODE, paste(RM_var, collapse = "|")),
! str_detect(CODE, "RSD")) %>%
mutate(units = floor(area_sqft * Max.occupied / unit.area))
parcels_RM <- parcels %>%
filter(str_detect(CODE, paste(RM_var, collapse = "|"))) %>%
mutate(units = floor(area_sqft * FAR / unit.area))
final_parcels <- rbind(parcels_RSD, parcels_RSA, parcels_RM)
# final_parcels %>%
#   dplyr::select(market_value, units, geometry) %>%
#   st_write("D:/Spatial_Optimization/Final/data/parcels.shp")
# final_parcels %>%
#   dplyr::select(market_value, units, geometry) %>%
#   st_centroid() %>%
#   st_write("D:/Spatial_Optimization/Final/data/all_parcels_nodes.shp")
sum(final_parcels$units)
View(final_parcels)
